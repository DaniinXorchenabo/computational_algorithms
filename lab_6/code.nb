
GlobalFunc[XX_] := (1 + Cos[XX]) * Exp[ XX ];

rectangleMethod[oldFrom_, oldTo_, funcFromParam_, eps_] := (
    locFrom = oldFrom;
    locTo = oldTo;
    locFunc[XXX_] = funcFromParam[XXX];
    lastSumm = 100;
    summ = 0;
    For[
        locSetup1 = 1,
        Abs[lastSumm - summ] >= eps,
        locSetup1 = locSetup1 / 2;
        lastSumm = summ;
        summ = 0;

        For[
            i = a - locSetup1,
            i < b,
            i += locSetup1;
            summ += locFunc[i];
        ];
        summ = summ * locSetup1;
    ];

    {N[summ, 20], N[locSetup1], locFrom, locTo}

);

trapezoidMethod[oldFrom_, oldTo_, funcFromParam_, eps_] := (
    locFrom = oldFrom;
    locTo = oldTo;
    locFunc[XXX_] = funcFromParam[XXX];
    lastSumm = 100;
    summ = 0;
    For[
        locSetup2 = 1,
        Abs[lastSumm - summ] > eps,
        locSetup2 = locSetup2 / 2;
        lastSumm = summ;
        summ = 0;
        For[
            i = locFrom,
            i < locTo - locSetup2,
            i += locSetup2;
            summ += locFunc[i];
        ];
        summ = (summ + (locFunc[locFrom] + locFunc[locTo]) / 2) * locSetup2 ;
    ];
    {N[summ, 20], N[locSetup2], locFrom, locTo}
);

SimsonMethod[oldFrom_, oldTo_, funcFromParam_, eps_] := (
    locFrom = oldFrom;
    locTo = oldTo;
    locFunc[XXX_] = funcFromParam[XXX];
    lastSumm = 100;
    summm = 0;
    count = 0;
    sumHistory = {};
    m = 0;
    For[
        m = 0,
        count < 10,
        m = m + 1;
        lastSumm = summm;
        summm = 0;
        For[
            i = 0,
            i < m,
            i += 1;
            summm = summm + locFunc[2 * i - 2] + 4 * locFunc[2 * i - 1] + locFunc[2 * i];
        ];
        h = (locTo - locFrom) / (2 * m);
        summm =  (h * summm / 3) ;
        sumHistory = Append[sumHistory, N[summm, 20]];
        count+=1;

    ];
    {N[summm, 10],  locFrom, locTo, sumHistory}
);


Simson2Method[oldFrom_, oldTo_, funcFromParam_, eps_] := (
    locFrom = oldFrom;
    locTo = oldTo;
    locFunc[XXX_] = funcFromParam[XXX];
    lastSumm = 100;
    summm = 0;
    n = 2;
    For[
        n = 2,
        Abs[lastSumm - summm ] >= eps / 2,
        n = n * 2;
        dx = 1.0 * (locTo - locFrom) / n;
        lastSumm = summm;
        summm = locFunc[locFrom] + 4 * locFunc[locFrom + dx] + locFunc[locTo];
        For[
            i = 0,
            i < IntegerPart[n / 2],
            i += 1;
            summm +=  2 * locFunc[locFrom + (2 * i) * dx] + 4 * locFunc[locFrom +(2 * i + 1) * dx ];
        ];
        summm =  summm * dx / 3 ;

    ];
    {N[summm, 20],  locFrom, locTo}
);

res1 = rectangleMethod[a, b, GlobalFunc, eps];
res2 = trapezoidMethod[a, b, GlobalFunc, eps];
res3 = Simson2Method[a, b, GlobalFunc, eps];
{"rectangle" -> res1, "trapezoid" -> res2, "simson" -> res3}